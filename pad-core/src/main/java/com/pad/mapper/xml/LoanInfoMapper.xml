<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.pad.mapper.LoanInfoMapper">

    <!--分页查询，查询出企业名称和银行名称-->
    <select id="pageQuery" resultType="loanInfo">
        select l.*,c.`name`,b.bank_name
        from loan_info l
                 left join company_info c on c.c_no=l.c_no
                 left join bank b on b.bank_no=l.bank_no
        <trim prefix="where" prefixOverrides="and">
             <if test="param2!=null">
                 <if test="param2.name!=null">
                     and c.`name`=#{param2.name}
                 </if>
                 <if test="param2.bankName!=null">
                     and b.bank_name=#{param2.bankName}
                 </if>
                 <if test="param2.amount!=null">
                     and l.amount=#{param2.amount}
                 </if>
                 <if test="param2.purpose!=null">
                     and l.purpose=#{param2.purpose}
                 </if>
                 <if test="param2.period!=null">
                     and l.period=#{param2.period}
                 </if>
             </if>
        </trim>
    </select>

    <!--逻辑删除-->
    <update id="deleteLoanInfoByIds" parameterType="list">
        update loan_info
        set is_deleted=0
        where id in
        <foreach collection="list" item="id" separator="," open="(" close=")">
            #{id}
        </foreach>
    </update>

    <!--按贷款编号查询每个贷款信息-->
    <select id="findById" parameterType="String" resultType="loanInfo">
        select l.*,c.`name`,b.bank_name
        from loan_info l
                 left join company_info c on c.c_no=l.c_no
                 left join bank b on b.bank_no=l.bank_no
        where l.c_no=#{id}
    </select>

</mapper>
